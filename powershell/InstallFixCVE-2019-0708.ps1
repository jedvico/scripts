<#
.DESCRIPTION
    This script is run locally. Checks for the specific update
    presence in the system and if it is not present it will try 
    to install it from the source defined in top lines of this
    script.
.NOTES
    Author: @jedvico
#>

# Target fix installersh
$updx64 = "\\192.168.1.160\installers\Updates\w7x64.msu"
$updx32 = "\\192.168.1.160\installers\Updates\w7x86.msu"

# Select Windows Update service 
$service = get-service -name wuauserv

# Pull the system info and search for security update is installed
$update = systeminfo.exe | findstr KB4499175

# Check if the fix is already installed, will return true if present
if(-not [string]::isnullorempty($update))
{
    # Set Windows Update to Automatic so it can be started / stopped
    set-service $service -startuptype automatic

    # Start the service
    start-service $service

    # Get client architecture 
    $OSArch = (get-wmiobject win32_operatingsystem).osarchitecture

    # Switch among OS architectures to install the fix through wusa
    switch($OSArch) 
    {
        "64-bit"{wusa.exe $updx64 /quite}
        "32-bit"{wusa.exe $updx32 /quite}
    }
}
